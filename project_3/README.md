# BENG 285 / BNFO 285 / ECE 204 - Team 3 Repository for Project 3

Welcome to the shared codebase for Team 3 in the BENG 285 / BNFO 285 / ECE 204 course.

This repository contains the code developed for Project 3.

## Team Members

- Aleysha Chen
- Banghua Xu
- Eric Xue
- Haowen Zhou
- Jiaming Weng
- Peiyuan Han

## How to run the code

### Install python dependencies
```bash
pip install -r requirements.txt
```

### Mutational Matrix Generator (`matrix_generator`)
To run:
```bash
cd matrix_generator
bash cmd.sh
```
Make sure you have the input file `TCGA.LUAD.mutations.txt` in the `data` directory. You will get a `output/sbs_96_matrix.tsv` file as output. The code will also compare the matrix generated by our code with the matrix generated by SigProfiler and print the results.

### Mutational Signature Extractor (`extractor`)
Our NMF-based mutational signature extractor algorithm is implemented in `NMF.ipynb`. The hyperparameters searching code using our algorithm is implemented in `NMF_hyperparam_sweep_stability.ipynb`. The hyperparameters search results are saved in `parameter_search_our_results/`.

### SigProfilerExtractor
```bash
python run_SigProfilerExtracter.py
```
This code will generate a folder `SigProfilerResults/SigProfilerExtractorResultsWithCosmic` containing the results of the signature extraction.

### SigProfilerAssignment
```bash
python run_SigProfilerAssignment.py \
    -i ./parameter_search_our_results/W_optim_k_4.tsv \
    -o ./SigProfilerResults/SigProfilerAssignmentResultsWithCosmic
```
This code will generate a folder `SigProfilerResults/SigProfilerAssignmentResults` containing the results of the signature assignment.

### Benchmark between our algorithm and SigProfiler
Please use the R script `benchmark/proj3.R` to benchmark the results between our algorithm and SigProfiler.